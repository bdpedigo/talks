---
marp: true
theme: aibs
size: 16:9
paginate: true
math: true
backgroundImage: url(../themes/aibs-backgrounds/default.png)
transition: fade 0.1s
---

<!-- TODO cell types plot -->

<style>
a {
  position: fixed;
}
embed{
  border: 0px;
}
h1 {
  margin-bottom: 0px;
  padding-bottom: 5px;
}
section {
  --soma: rgb(0, 190, 255);
  --shaft: rgb(221, 179, 16);
  --spine: rgb(251, 73, 176);
  --multi-spine: rgb(145, 19, 204);
  --exc: rgb(237,147,108);
  --inh: rgb(149, 204, 184);
  --legend: |
  <div style="font-size:16px">
  <span style="color: var(--soma);">soma</span> <span style="color: var(--shaft);">shaft</span> <span style="color: var(--spine);">spine</span> 
  <img src="./../.../../images/ssa/icons/sphere-dashed.svg" style="display: inline; position: relative; top: 2px"></img> vortex
  <img src="./../images/icons/rect.svg" style="display: inline; position: relative; top: 2px"></img> model
  </div>;
}
img {
  display: inline;
  position: relative;
  top: 2px
}
[data-morph] {
  view-transition-name: attr(data-morph type(<custom-ident>), none);
}
section::after {
    content: attr(data-marpit-pagination) '/26';
}
.extra-slide {
  display: none;
}
</style>

<!-- _paginate: false -->
<!-- _backgroundImage: ../themes/aibs-backgrounds/blank.png -->

![bg opacity:0.4](../../images/ssa/boosted_model_posteriors/864691135361404743_posterior.svg)

<br>

# Mapping millions of postsynaptic structures in a large electron microscopy volume of mouse V1

<div class="columns">
<div>

<br>
<br>
<br>
<br>
<br>

Ben Pedigo
(he/him)
Scientist I
Allen Institute
[ben.pedigo@alleninstitute.org](mailto:ben.pedigo@alleninstitute.org)

<div style='' >

</div>

</div>
<div>

</div>
</div>

---

<style scoped>
.fig belowcaption {
    position: absolute;
    bottom: 0%;
    left: 15%;
    vertical-align: top;
    text-anchor: start;
    font-size: 20px;
    font-weight: normal;
}
</style>

# MICrONS anatomy

<div class="columns">
<div>

<figure class='fig'>
<img src="../../images/ssa/microns_covers/minnie_activity_12color.png" style="display: block;" data-morph="microns"></img>

<belowcaption>

<!-- MICrONS - Image by Forrest Collman -->

</belowcaption>

</figure>

</div>
<div>

* Opportunity: many examples of {dendrites, synapses, mitochondria ...}
* Challenge: scale is beyond what a human can label
* SegCLR (Dorkenwald et al. 2023), SynapseCLR (Wilson et al.2023), NEURD (Celli et al. 2025), Soma-nucleus model (Elabaddy et al. 2025), GraphDINO (Weis et al. 2025), PSS autoencoder (Seshamani et al. 2020)
* Spines? (according to **VORTEX**...)

</div>
</div>

<!-- _footer: MICrONS consortium et al. Nature (2025) -->

---

![h:400 center](../../images/ssa/sss-diagram.png)

<div id='highlightbox'>

# <!-- fit --> Goal: scalable, accurate postsynaptic structure prediction

</div>

---

<!-- First choice to make is what representation to use -->
<!-- Explain what segmentation, mesh, and skeleton are -->
<!-- Each of these differs in scale and size and ease of operaition etc. -->
<!-- First intuition was that we should be able to use the mesh to find spines, because people do -->

# Morphological representations

<div class="columns">
<div>

Segmentation/imagery

![](../../images/ssa/explain_morphology_representations/segmentation.svg)

</div>
<div>

Mesh

<!-- ![](../../images/ssa/explain_morphology_representations/mesh.svg) -->

<img src="../../images/ssa/explain_morphology_representations/mesh.svg" data-morph="mesh"></img>

</div>
<div>

Skeleton

![](../../images/ssa/explain_morphology_representations/skeleton.svg)

</div>
</div>

<!-- <div style="text-align: center">

$\leftarrow$ More expensive &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Less expensive $\rightarrow$

</div> -->



<!-- _transition: fade 1s -->

---

# How to generate features for a mesh?

<div class="columns">
<div>

<img src="../../images/ssa/explain_morphology_representations/mesh.svg" data-morph="mesh"></img>

</div>
<div>

![center](../../images/ssa/sun-et-al.png)

</div>
</div>

---

# Defining the heat kernel signature (HKS)

![h:350 center](../../images/ssa/explain_pipeline/explain_hks_partial_clean.png)

---

# Defining the heat kernel signature (HKS)

![h:350 center](../../images/ssa/explain_pipeline/explain_hks_full_clean.png)

- $k_{t}(x)$: amount of heat left at $x$ after time $t$.
- For timescales $\{t_1, ... t_d\}$ the HKS for point $x$ is $HKS(x) = [k_{t_1}(x), ..., k_{t_d}(x)]$

<!-- - May scale these: $\frac{k_{t_1}(x)}{\sum_i k_{t_1}(i)}$ -->

<!-- <div id="highlightbox"> HKS is a vector for each <span style="font-weight: bold">node</span> in a mesh which describes its heat diffusion properties </div> -->

---

# HKS by postsynaptic type

![h:550](../../images/ssa/diagram_heat_on_labeled_cell/diagram_heat_on_labeled_cell_1.png)

---

# HKS by postsynaptic type

![h:550](../../images/ssa/diagram_heat_on_labeled_cell/diagram_heat_on_labeled_cell_2.png)

<div style="background-color: white; font-size:20px; position: absolute; bottom: 0.6in; left: 6.6in;">

Bethanny Danskin
Erika Neace
Rachael Swannstrom

</div>

---

# HKS by postsynaptic type

![h:550](../../images/ssa/diagram_heat_on_labeled_cell/diagram_heat_on_labeled_cell_3.png)

<div style="background-color: white; font-size:20px; position: absolute; bottom: 0.6in; left: 6.6in;">

Bethanny Danskin
Erika Neace
Rachael Swannstrom

</div>

---

# HKS-based classifier

<div class="columns">
<div>

![h:550 center](../../images/ssa/diagram_heat_on_labeled_cell/hks_curves_by_label.png)

</div>
<div>

- Sparse training data (synapse labels from VORTEX), ~10,000s$^*$ examples
- Simple classifier on top (random forest)

</div>
<div>

~96% accuracy for synapses on held-out neurons

![](../../images/ssa/profile_approaches2/confusion_matrix.svg)

</div>
</div>

---

# HKS-based classifier across neuron types

![](../../images/ssa/cell-types-and-zoom.png)

<div style="font-size:25px; position: absolute; bottom: 1in; left: 1in;">

<span style="color: var(--soma)">soma</span> <span style="color: var(--shaft)">shaft</span> <span style="color: var(--spine)">spine</span>

</div>




---

# Computational pipeline

![](../../images/ssa/explain_pipeline/explain_pipeline_mosaic_simple.svg)

<!-- _footer: Garland and Heckbert 1997, Vallet and Levy 2008, Sharp and Crane 2020 -->

---

# Reasonable shortcuts

<div class="columns">
<div>

![](../../images/ssa/profile_approaches2/time_comparison.svg)

</div>
<div>

![](../../images/ssa/profile_approaches2/storage_comparison.svg)

</div>
<div>

![](../../images/ssa/profile_approaches2/test_accuracy_comparison_zoom.svg)

</div>
</div>



---

# MICrONS - data asset

![center h:350](../../images/ssa/ssa-result-diagram.png)

<div class="columns">
<div>

* ~208M synapses classified
* ~$250 in cloud compute
* Features stored for easy update

</div>
<div>

* Available in CAVE: `synapse_target_predictions_ssa`
* Coming soon: spine morphometry, model update


</div>
</div>

---

<!-- </div>
<div>

![](../../images/ssa/column_io_summary_from_mega/spine_synapse_proportion_histograms.svg)
 -->

## Inputs onto spines by cell type

<div class="columns">
<div>

![h:670 center](../../images/ssa/figures/diagram_cells/composite_synapses_onto_exc.png)

</div>
<div>

![](../../images/ssa/figures/column_io_summary_from_mega/cell_type_input_spine_proportion.svg)

</div>
</div>

<div style="font-size:25px; position: absolute; top: 1in; left: 1in;">
<span style="color: var(--soma)">soma</span> <span style="color: var(--shaft)">shaft</span> <span style="color: var(--spine)">spine</span>
</div>

<div style="font-size:25px; position: absolute; top: .85in; right: 1.4in;">
<span style="color: var(--inh)">inhibitory</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: var(--exc)">excitatory</span>
</div>


---

## Outputs onto excitatory spines

<div class="columns">
<div>

![h:670 center](../../images/ssa/figures/diagram_cells/composite_synapses_from_exc_to_exc.png)

</div>
<div>

![](../../images/ssa/figures/column_io_summary_from_mega/cell_type_output_proportion_to_excitatory_scatter.svg)

</div>
</div>

<div style="font-size:25px; position: absolute; top: 1in; left: 1in;">

<span style="color: var(--soma)">soma</span> <span style="color: var(--shaft)">shaft</span> <span style="color: var(--spine)">spine</span>

</div>

<div style="font-size:25px; position: absolute; top: .85in; right: 1.4in;">
<span style="color: var(--inh)">inhibitory</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: var(--exc)">excitatory</span>
</div>

---

## Outputs onto multi-input spines

<div class="columns">
<div>

![h:670 center](../../images/ssa/figures/diagram_cells/composite_synapses_from_exc_to_multi.png)

</div>
<div>

![](../../images/ssa/figures/column_io_summary_from_mega/cell_type_output_proportion_multi_spine_to_excitatory.svg)

</div>
</div>

<div style="font-size:25px; position: absolute; top: 1in; left: .9in;">
<span style="color: var(--multi-spine)">synapse to multi-input spine</span>
</div>

<div style="font-size:25px; position: absolute; top: .85in; right: 1.4in;"> <span style="color: var(--exc)">excitatory</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: var(--inh)">inhibitory</span>
</div>

---

# Multi-input spines with known pre-synaptic cells

<div class="columns-br">
<div>

![](../../images/ssa/figures/diagram_cells/composite_1E1I_synapse.png)

</div>
<div>

![](../../images/ssa/figures/column_io_summary_from_mega/multi_synapse_size_vs_spine_volume_crop.png)

</div>
</div>

---

# Multi-input spines with known pre-synaptic cells

<div class="columns-br">
<div>

![](../../images/ssa/figures/diagram_cells/composite_1E1I_synapse.png)

</div>
<div>

![](../../images/ssa/figures/column_io_summary_from_mega/multi_synapse_size_vs_spine_volume.png)

</div>
</div>

---

<!-- _backgroundImage: ../themes/aibs-backgrounds/blank.png -->

![bg opacity:0.2](../../images/ssa/boosted_model_posteriors/864691135361404743_posterior.svg)

## Summary

* HKS can be used to accurately classify postsynaptic structures
* Developed an efficient pipeline for generating and storing these features
* Annotations available in MICrONS
* Examined how cell type connectivity varies with respect to postsynaptic compartment

## Future work


<!-- * Higher order learning on top of HKS features (e.g. GNN) -->

<!-- * Infrastructure for managing, updating, and querying large feature sets -->
<!-- * Improving on disconnected/merged mesh regions -->

---

# Zero-shot transfer performance

![h:550 center](../../images/ssa/figures/display_across_datasets/display_across_datasets.png)

<div style="font-size:25px; position: absolute; bottom: 1in; left: 1in;">

<span style="color: var(--soma)">soma</span> <span style="color: var(--shaft)">shaft</span> <span style="color: var(--spine)">spine</span>

</div>

<!-- _footer: MICrONS Consortium et al Nature (2025), unpublished, Zheng at al. bioRxiv (2025), Shapson-Coe et al. Science (2024) -->

---

<!-- https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/5738188566953984 -->

# Classifying presynaptic E/I

<div class="columns">
<div>

![](../../images/ssa/pre-post-labeled.png)

Synapse features:
  $$[ \color{#C77C46} \text{pre HKS}, \color{#68E044} \text{post HKS}, \color{black} \text{synapse size} ]$$
$\rightarrow$ RF to predict excitatory/inhibitory axon

</div>
<div>

![](../../images/ssa/ei/ei_synapse_distance_threshold.svg)

<!-- ![](../../images/ssa/ei/agg-distance.png) -->

</div>
</div>


---

<!-- _backgroundImage: ../themes/aibs-backgrounds/blank.png -->

![bg opacity:0.2](../../images/ssa/boosted_model_posteriors/864691135361404743_posterior.svg)

## Summary

- HKS can be used to accurately classify postsynaptic structures
- Developed an efficient pipeline for generating and storing these features
- Annotations available in MICrONS
- Examined how cell type connectivity varies with respect to postsynaptic compartment

## Future work

* Models based on HKS appear to transfer well between datasets
* HKS features can be used for other tasks (e.g. predicting E/I of axon fragments)


<!-- * Higher order learning on top of HKS features (e.g. GNN) -->

<!-- * Infrastructure for managing, updating, and querying large feature sets -->
<!-- * Improving on disconnected/merged mesh regions -->

---

# Acknowledgements

<style scoped>
p {
    font-size: 10px;
}
h6 {
  font-size: 14px;
}

</style>

<div class="columns">
<div>

<ins>_Connectomics_</ins>
**Casey M. Schneider-Mizell​**
**Forrest Collman​**
**Bethanny Danskin​**
**Erika Neace​**
**Rachel Swanstrom​**
Agnes Bodor​
Adam Bleckert​
JoAnn Buchanan​
Cameron Devine​
Dan Bumbarger​
Derrick Brittain​
Steven Cook​
Nuno da Costa​
Sven Dorkenwald​
Leila Elabbady​
Kim Gruver​
Elizabeth Guadarrama​
Emily Joyce​
Dan Kapner​
Sam Kinn​
Cheryl Lea​
Xiaoyu Lu​
Gayathri Mahalingam​
Sid Rath​
Clay Reid​
Sharmi Seshamani​
Jenna Schardt​
Marc Takeno​
Russel Torres​
Keith Wiley​
Wenjing Yin​
Wan-Qing Yu​
Chi Zhang​

</div>
<div>

<ins>_PM_</ins>
Lynne Becker
Florence D'Orazi 
Melissa Lerch
Sarah Naylor
Shelby Suckow
Susan Sunkin
David Vumbaco

<ins>_Morphology and 3D Reconstruction_</ins>
Rachel Dalley
Clare Gamlin
Staci Sorensen
Grace Williams

<ins>_Modeling & Simulation_</ins>
Ani Nandi
Tom Chartrand
Anatoly Buchin
Yina Wei
Soo Yeun Lee
Costas Anastassiou

<ins>_Technology_</ins>
Tim Fliss
Rob Young
And others

<ins>_IT_</ins>
Brian Youngstrom
Stuart Kendrick
Scott Harrison
Nathaniel Middleton
And others

</div>
<div>

<ins>_MPE_</ins>
Jay Borseth
Collin Farrell
And others

<ins>_MindScope_</ins>
Reza Abbasi-Asi
Anton Arkhipov
Michael Buice
Daniel Denman
Brian Hu
Josh Larkin
Stefan Mihalas
Daniel Millmann
Gabe Ocker
Naveen Ouellette
Kevin Takasaki
Saskia de Vries
Jun Zhuang

<ins>_Alen Institute for Brain Science_</ins>
Tanya Daigle
Shenqin Yao
Nikolas Jorstad
Trygve Bakken
Rebecca Hodge
Nathan Gouwens
Bosiljka Tasic
Ed Lein
Hongkui Zeng
And many others

</div>
<div>

<ins>_Princeton_</ins>
Tommy Macrina
Sebastian Seung
Nick Turner
And team

<ins>_Baylor_</ins>
Jake Riemer
Andreas Tolias
And team

<ins>_Harvard Medical School_</ins>
Brett Graham
Wei-Chung Lee
And team

<ins>_Janelia_</ins>
Khaled Khairy
Stephan Saalfeld
Carolyn Ott
Jennifer Lippincott-Schwartz
And others

<ins>_JHU_</ins>
Jenna Glatzer
Dwight Bergles

<ins>_APL_</ins>
Brock Wester
And team

</div>
<div>

<ins>_Neuro Surgery and Behavior_</ins>
<ins>_Lab Animal Services_</ins>
<ins>_Transgenic Colony Management_</ins>
<ins>_Finance_</ins>
<ins>_Legal_</ins>

<ins>_Computing Resources_</ins>
BBP5 Supercomputing Resources
National Energy Research Computing Center
AI HPC
Google Cloud

<ins>_Funding_</ins>
IARPA - MICRONS
NSF - NeuroNex
NIH – BICCN/BICAN, BRAIN CONNECTS

</div>
</div>

###### We wish to thank the Allen Institute founder, Paul G. Allen, for his vision, encouragement, and support.

---

# Questions?

<!-- _backgroundImage: ../themes/aibs-backgrounds/blank.png -->

![bg opacity:0.4](../../images/ssa/boosted_model_posteriors/864691135361404743_posterior.svg)

<br>
<br>
<br>
<br>
<br>
<br>
<br>

Ben Pedigo
(he/him)
Scientist I
Allen Institute for Brain Science
[ben.pedigo@alleninstitute.org](mailto:ben.pedigo@alleninstitute.org)

---

<!-- NOTE at a high level, we can look at things in terms of their laminar distribution -->
<!-- NOTE there is an abundance of synapses onto spines in upper layers  -->

# Spatial distribution of synapses

<div class="columns">
<div>

<div style="font-size:16px">
<span style="color: var(--soma);">soma</span> <span style="color: var(--shaft);">shaft</span> <span style="color: var(--spine);">spine</span>
</div>

![center h:520](../../images/ssa/synapse_spatial/synapse_cloud_layered.svg)

<!-- 1.3M synapses (= .63% of classified) -->

</div>
<div>

![center h:500](../../images/ssa/synapse_spatial/synapse_spatial_kde.svg)

</div>
</div>

---

<div class="columns-br">
<div>

# Synapses by E/I

Synapses from cleaned axons where pre- and post- have E/I classifications (1.3M synapses total)

</div>
<div>

![h:600 center](../../images/ssa/tabulation_by_type/empty.svg)

</div>
</div>

<!-- _footer: Cell types from Schneider-Mizell et al. Nature (In press), Elabbady et al. Nature (In press) -->

---

# Multi-input spines

<!-- TODO EXP add a nice image here of more than one axon onto a spine -->

<div class="columns">
<div>

* Most (>90%) excitatory spines receive a single excitatory input
* Some excitatory spines receive two
  - Specifically one E, one I
  - Enriched for thalamic input
  - More stable
* Multi-input spines common for inhibitory neurons

</div>
<div>

![](../../images/ssa/double-contact.png)

<!-- https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/6025508249665536 -->

</div>
</div>

<!-- _footer: Kubota et al _J. Neuroscience_ (2007), Villa et al _Neuron_ (2016), Hwang et al _Cerebral Cortex_ (2021) -->

---

# Finding multi-input spines

<div class="columns">
<div>

<span style="color: var(--soma);">soma</span> <span style="color: var(--shaft);">shaft</span> <span style="color: var(--spine);">spine</span> &nbsp;&nbsp;&nbsp; :black_circle: synapse detection

![](../../images/ssa/new_posterior_plots/zoom_posterior_colors.svg)

</div>
<div>

Connected components sharing a label

![](../../images/ssa/new_posterior_plots/zoom_component_colors.svg)

<div style="position: absolute; top: 1.8in; left: 9.5in;">Multi-input</div>
<div style="position: absolute; top: 2.2in; left: 9.5in; width: 140px; height: 140px; background-color: none; border-radius: 70px; border-width: 3px; border-color: black; border-style: solid;"></div>

<div style="position: absolute; top: 4.1in; left: 10.8in;">Single-input</div>
<div style="position: absolute; top: 4.5in; left: 10.8in; width: 140px; height: 140px; background-color: none; border-radius: 70px; border-width: 3px; border-color: black; border-style: solid;"></div>

</div>
</div>

---

# <!-- fit --> A triple-input spine onto an excitatory cell

<!-- https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/6077690223263744 -->

![h:525 center](../../images/ssa/triple-spine.png)

---

<div class="columns-br">
<div>

# Synapses by E/I

Synapses from cleaned axons where pre- and post- have E/I classifications (1.3M synapses total)

</div>
<div>

![h:600 center](../../images/ssa/tabulation_by_type/ei_synapse_proportions_w_multi_just_e_e.svg)

</div>
</div>

<!-- _footer: Cell types from Schneider-Mizell et al. Nature (In press), Elabbady et al. Nature (In press) -->

---

<div class="columns-br">
<div>

# Synapses by E/I

Synapses from cleaned axons where pre- and post- have E/I classifications (1.3M synapses total)

</div>
<div>

![h:600 center](../../images/ssa/tabulation_by_type/ei_synapse_proportions_w_multi.svg)

</div>
</div>

<!-- _footer: Cell types from Schneider-Mizell et al. Nature (In press), Elabbady et al. Nature (In press) -->

---

<!-- NOTE because microns also has some cell type information, we can also look at a similar plot but now broken out by cell type
-->
<!-- NOTE a lot going on here, but going to draw your attention to just a few things -->

<div class="columns-br">
<div>

# Synapses by cell type

</div>
<div>

![h:600 center](../../images/ssa/tabulation_by_type/cell_type_synapse_proportions_w_multi.svg)

</div>
</div>

<!-- _footer: Cell types from Schneider-Mizell et al. Nature (In press) -->

---

# Basket cells target somas, even of inhibitory cells

![](../../images/ssa/tabulation_by_type/bc_targets.svg)

<div class="columns">
<div>

![center](../../images/ssa/example_contacts/bc_to_inhibitory/state=4910284205457408.png)

<!-- https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/4910284205457408 -->

<span style="color: #e1562c">Basket </span> $\rightarrow$ <span style="color: #00cb85"> Basket</span>

</div>
<div>

![center](../../images/ssa/example_contacts/bc_to_inhibitory/state=6700069303615488.png)

<!-- https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/6700069303615488 -->

<span style="color: #e1562c">Basket</span> $\rightarrow$ <span style="color: #00cb85"> Bipolar </span>

</div>
<div>

![center](../../images/ssa/example_contacts/bc_to_inhibitory/state=6074562245558272.png)

<!-- https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/6074562245558272 -->

<span style="color: #e1562c">Basket</span> $\rightarrow$ <span style="color: #00cb85"> Martinotti </span>

</div>
</div>

---

# L6 CT cells target shafts of other excitatory cells

![](../../images/ssa/tabulation_by_type/6pct_targets.svg)

<div class="columns">
<div>

![center](../../images/ssa/example_contacts/6ct_to_e_shaft/state=4808939033067520.png)

<!-- https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/4808939033067520 -->

<span style="color: #e1562c">6P-CT </span> $\rightarrow$ <span style="color: #00cb85"> 4P</span>

</div>
<div>

![center](../../images/ssa/example_contacts/6ct_to_e_shaft/state=6560729223135232.png)

<!-- https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/6560729223135232 -->

<span style="color: #e1562c">6P-CT </span> $\rightarrow$ <span style="color: #00cb85"> 5P-ET</span>

</div>
<div>

![center](../../images/ssa/example_contacts/6ct_to_e_shaft/state=4835245372211200.png)

<span style="color: #e1562c">6P-CT </span> $\rightarrow$ <span style="color: #00cb85"> 5P-IT</span>

<!-- https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/4835245372211200 -->

</div>
</div>

---

# 5P-ET to Martinotti spines

<!-- TODO add text to this slide -->

<!-- __backgroundImage: ../themes/aibs-backgrounds/blank.png -->

<div class="columns">
<div>

![h:550](../../images/ssa/tabulation_by_type/cell_type_synapse_proportions_w_multi.svg)

<!-- add an absolute position white box without text, with black border -->

<!-- block out upper left corner -->
<div style="position: absolute; bottom: 5.26in; right: 7.76in; width: 4.4in; height: .94in; background-color: white; opacity:0.9; border: 0px solid black;"></div>

<!-- block out lower left corner -->
<div style="position: absolute; top:2.7in; right: 7.76in; width: 4.4in; height: 4.2in; background-color: white; opacity:0.9; border: 0px solid black;"></div>

<!-- block out upper right corner -->
<div style="position: absolute; bottom: 5.26in; left: 6.05in; width: .6in; height: .94in; background-color: white; opacity:0.9; border: 0px solid black;"></div>

<!-- block out lower right corner -->
<div style="position: absolute; top:2.7in; left: 6.05in; width: .6in; height: 4.2in; background-color: white; opacity:0.9; border: 0px solid black;"></div>

<!-- red block in the gap between the above -->
<div style="position: absolute; top: 2.35in; left: 5.7in; width: 0.4in; height: .5in; backbround-color: none; border: 3px solid red; border-radius:20px"></div>

</div>
<div>

<div class="columns-br-tight">
<div>

<span style="color: #e1562c">5P-ET </span> $\rightarrow$ <span style="color: #00cb85"> Martinotti</span>

</div>
<div>

![center](../../images/ssa/example_contacts/5et_to_mc/state=6128785033265152.png)

</div>
</div>

<div class="columns-br-tight">
<div>

<span style="color: #e1562c">5P-ET </span> $\rightarrow$ <span style="color: #00cb85"> Martinotti</span>

</div>
<div>

![center](../../images/ssa/example_contacts/5et_to_mc/state=6310820913872896.png)

</div>
</div>


<!-- 

![center h:200](../../images/ssa/example_contacts/5et_to_mc/state=6128785033265152.png) -->

<!-- ![center h:200](../../images/ssa/example_contacts/5et_to_mc/state=6310820913872896.png) -->

<!-- <figure class='fig'>
<img src="../../images/ssa/example_contacts/5et_to_mc/state=6310820913872896.png" />
</figure> -->

</div>
</div>

<!-- _footer: Bodor et al. Nature Neuroscience (In press) -->

---

# Variability within type

![center h:550](../../images/ssa/projection_by_cell_scatters/cell_type_scatter_no_auto.svg)

<!-- add an span with absolute positioning above the figure -->
<!-- 
<span style="position: absolute; top: 4in; left: 8in; font-size: 15px; background-color: white; padding: 5px; border-radius: 5px; color: red">Manually classified (Schneider-Mizell et al. Nature 2025)</span>

<span style="position: absolute; top: 4.25in; left: 8in; font-size: 15px; background-color: white; padding: 5px; border-radius: 5px; color: #1f77b4">Automatically classified (Elabbady et al. Nature 2025)</span> -->

<!-- _footer: Cells types from Schneider-Mizell et al. Nature (In press) -->

---

# Perisomatic targeting cells

![h:500 center](../../images/ssa/basket-cell-spineyness.png)

<div class="columns">
<div>

<span style="color:#4da0ff; text-align: right; display: block">~1% inputs onto spines</span>

</div>
<div>

<span style="color: #FFA94D">~23% inputs onto spines</span>

</div>
</div>

<!-- https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/6748095493701632 -->


--- 

# Variability within type

![center h:550](../../images/ssa/projection_by_cell_scatters/cell_type_scatter_with_auto.svg)


<span style="position: absolute; top: 4in; left: 8in; font-size: 15px; background-color: white; padding: 5px; border-radius: 5px; color: red">Manually classified (Schneider-Mizell et al. Nature 2025)</span>

<span style="position: absolute; top: 4.25in; left: 8in; font-size: 15px; background-color: white; padding: 5px; border-radius: 5px; color:rgb(83, 83, 83)">Automatically classified (Elabbady et al. Nature 2025)</span>

<!-- _footer: Cells types from Schneider-Mizell et al. Nature (In press), Elabbady et al. Nature (In press) -->

---

# Accessing the data

Available in the **C**onnectome **A**nnotation and **V**ersioning **E**ngine (CAVE):
```python
from caveclient import CAVEclient
client = CAVEclient("minnie65_public", version=1300)
client.materialize.query_table(
    "synapse_target_predictions_ssa",
    limit=2,
    select_columns=["target_id", "pre_pt_root_id", "post_pt_root_id", "tag", "size"],
)
```

```plaintext
pre_pt_root_id	        post_pt_root_id	        size	target_id	tag
864691135468221308	864691135383487706	4284	306517361	spine
864691135979239816	864691135383487706	1620	285512620	shaft
```

<!-- _footer: CAVE: Dorkenwald, Schneider-Mizell et al Nature Methods (In press) -->


<!-- 
* Developed a method based on spectral shape analysis (HKS) for classifying postsynaptic structures based on mesh alone
* Scaled this system to robustly classify >200M synapses in MICrONS
* Described initial findings on how postsynaptic structure targeting varies by cell type -->


<!-- 
---

# Future directions

<div class="columns">
<div>

- Other classification/segmentation tasks (e.g. axonal boutons)
* Add morphometry (e.g. compute spine volumes, surface area, etc.)
* Study spatial distribution of spine densities on individual neurons
* Deploy on more datasets

</div>
<div>


</div>
</div> -->



---

# Variability within type - outputs 

![h:550 center](../../images/ssa/projection_by_cell_scatters/cell_type_scatter_outputs.svg)

---

# An aside...

<div class="columns">
<div>

Many generalizations/extensions of HKS:

- Alternative computational schemes:
  <span style="font-size: 14px">Nasikun et al. 2018; Nasikun et al. 2022; Magnet and Ovsjanikov 2023, Hammond et al. 2009; Shuman et al. 2011; Huang et al. 2020 </span>
- Volumetric HKS:
  <span style="font-size: 14px">Raviv et al. 2010; Rustamov et al. 2009; Rustamov 2011</span>

</div>
<div>

HKS features:

$$h_t(x) = \sum_{i=0}^{D} e^{-\lambda_i t} \phi_i(x)^2$$

Learned spectral features (Litman & Bronstein 2014):

$$x_t(x) = \sum_{i=0}^{D} \textcolor{red}{f_t(\lambda)} \phi_i(x)^2$$

<!-- Spectral graph neural network layer (add citation): -->

</div>
</div>

---

# Heat diffusion

Imagine placing a unit of heat at a point on a surface, watching how that heat diffuses

![](https://upload.wikimedia.org/wikipedia/commons/d/d9/Fundamental_solution_to_the_heat_equation.gif)

<!-- _footer: https://en.wikipedia.org/wiki/Heat_equation -->

---

<div style="font-size:20px">
<span style="color: var(--soma);"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; soma</span> <span style="color: var(--shaft);">shaft</span> <span style="color: var(--spine);">spine</span>

<!-- ![gallery h:540 center](../../images/ssa/show_heat_diffusion/heat_diffusion_gallery.svg) -->

<img src="../../images/ssa/show_heat_diffusion/heat_diffusion_gallery.svg" height="540px" data-morph="gallery" style="display: block; margin: 0 auto;" ></img>

<div style="font-size:30px; text-align: center; top: -40px; position: relative;">

Increasing time $\rightarrow$

</div>

<!-- _transition: fade 0.5s -->

<!-- _footer: Sun et al., _Eurographics_ (2008) -->

<!-- ---

# Intuition for HKS matching

<style scoped>

p {
  font-size: 20px;
}

</style>

<div class="columns">
<div>

<!-- ![h:350 center](../../images/ssa/hks_paper_synthetic_example.png) -->

<!-- <img src="../../images/ssa/hks_paper_synthetic_example.png" data-morph="hks-plot" height=350px style="display: block; margin: 0 auto;"></img>

> ...all four points have isometric neighborhoods at small scales, their HKS’s are the same for small $t$’s ($< t_1$).

</div>
<div>

![center](../../images/ssa/horses.png) -->

<!-- <img src="../../images/ssa/horses.png" data-morph="octopus"></img> -->

<!-- </div>
</div> -->

<!-- __footer: Sun et al., _Eurographics_ (2008) -->


---

# Clustering on heat kernel signatures

<div class="columns">
<div>

![h:270 center](../../images/ssa/show_heat_diffusion/hks_lines.svg)

![center h:270](../../images/ssa/show_heat_diffusion/hks_clustermap.png)

<!-- <img src="../../images/ssa/show_heat_diffusion/hks_lines.svg" data-morph="hks-plot" height=270px style="display: block; margin: 0 auto;"></img> -->

</div>
<div>

<div>
<embed src="../../images/ssa/show_heat_diffusion/hks_clustered.html" width="96%" height="550px" name="hks_clustered" data-morph="octopus"></embed>

</div>
</div>
</div>


---

# Tracking heat diffusion

<div class="columns">
<div>

<!-- ![gallery](../../images/ssa/show_heat_diffusion/heat_diffusion_gallery.svg) -->

<img src="../../images/ssa/show_heat_diffusion/heat_diffusion_gallery.svg" data-morph="gallery"></img>

</div>
<div>

<img src="../../images/ssa/show_heat_diffusion/heat_diffusion_time_scale.svg" data-morph="hks-curves"></img>

</div>
</div>

<!-- _transition: fade 0.5s -->

---

# Defining the heat kernel signature (HKS)

<div class="columns">
<div>

<img src="../../images/ssa/show_heat_diffusion/heat_diffusion_time_scale.svg" data-morph="hks-curves"></img>

</div>
<div>

* $k_{t}(x)$: amount of heat left at $x$ after time $t$.
* For timescales $\{t_1, ... t_d\}$ the HKS for point $x$ is
  $$HKS(x) = [k_{t_1}(x), ..., k_{t_d}(x)]$$
* May scale these: $\frac{k_{t_1}(x)}{\sum_i k_{t_1}(i)}$

</div>
</div>

---

# Postsynaptic structure prediction (with labels)

<div class="columns">
<div>

![](../../images/ssa/vortex_labels/vortex_labels_example.svg)

</div>
<div>

- Synapse target labels from VORTEX _(Erika Neace, Rachael Swanstrom, Bethanny Danskin)_
* HKS features from the mesh point closest to synapse
* Random forest classifier

</div>
</div>

---

# <!-- fit --> Random forest on HKS is an accurate classifier

Train test split over _neurons_
<div class="columns">
<div>

![h:500 center](../../images/ssa/model_comparison/metrics-Heat-RF-NEURD.svg)

</div>
<div>

![h:500 center](../../images/ssa/model_comparison/metrics-Heat-RF.svg)

</div>
</div>

---

# CA3

<div class="columns">
<div>

##### The good

![h:250 center](../../images/ssa/ca3-good-wo-labels.png)

![h:250 center](../../images/ssa/ca3-good-w-labels.png)

</div>
<div>

##### The bad

![h:250 center](../../images/ssa/ca3-bad-wo-labels.png)

![h:250 center](../../images/ssa/ca3-bad-w-labels.png)

</div>
</div>

<!-- _footer: Zhihao Zheng, Changjoo Park -->

---

# Failure modes

<div class="columns">
<div>

### Merge

![](../../images/ssa/spine_merge_example.png)

</div>
<div>

### Remeshing issue

![](../../images/ssa/mesh_texture_example.png)

</div>
</div>


---

<div style="font-size:16px">
<span style="color: var(--soma);">soma</span> <span style="color: var(--shaft);">shaft</span> <span style="color: var(--spine);">spine</span>
</div>

<div>
<embed src="../../images/ssa/boosted_model_posteriors/864691135182486274_posterior.svg" width="96%" height="600px" name="864691135182486274_posterior"></embed>

<a href="../../images/ssa/boosted_model_posteriors/864691135182486274_posterior.html" target="864691135182486274_posterior">
<img src="./../.../../images/ssa/icons/search.svg"></img>
</a>
</div>

---

<div style="font-size:16px">
<span style="color: var(--soma);">soma</span> <span style="color: var(--shaft);">shaft</span> <span style="color: var(--spine);">spine</span>
</div>

<div>
<embed src="../../images/ssa/boosted_model_posteriors/864691135361404743_posterior.svg" width="96%" height="600px" name="864691135361404743_posterior"></embed>

<a href="../../images/ssa/boosted_model_posteriors/864691135361404743_posterior.html" target="864691135361404743_posterior">
<img src="./../.../../images/ssa/icons/search.svg"></img>
</a>
</div>

---

<div style="font-size:16px">
<span style="color: var(--soma);">soma</span> <span style="color: var(--shaft);">shaft</span> <span style="color: var(--spine);">spine</span>
</div>

<div>
<embed src="../../images/ssa/boosted_model_posteriors/864691135416507322_posterior.svg" width="96%" height="600px" name="864691135416507322_posterior"></embed>

<a href="../../images/ssa/boosted_model_posteriors/864691135416507322_posterior.html" target="864691135416507322_posterior">
<img src="./../.../../images/ssa/icons/search.svg"></img>
</a>
</div>

---

# Excitatory neurons

<div style="font-size:20px; padding: 0px; position: absolute; top: 0.6in; right: 0.7in;">
<span style="color: var(--soma);">soma</span> <span style="color: var(--shaft);">shaft</span> <span style="color: var(--spine);">spine</span>
</div>

<div class="columns">
<div>

<!-- ![](../../images/ssa/new_posterior_plots/864691135119068125-23P.svg) -->

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691135119068125-23P.svg" />
<figcaption >
23P
</figcaption>
</figure>

</div>
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691136067090584-4P.svg" />
<figcaption >
4P
</figcaption>
</figure>

</div>
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691135388264577-5P-IT.svg" />
<figcaption >
5P-IT
</figcaption>
</figure>

</div>
</div>

<div class="columns">
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691136362746082-5P-NP.svg" />
<figcaption >
5P-NP
</figcaption>
</figure>

</div>
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691136362774498-5P-PT.svg" />
<figcaption >
5P-ET
</figcaption>
</figure>

</div>
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691135688407776-6P-CT.svg" />
<figcaption >
6P-CT
</figcaption>
</figure>

</div>
</div>

<!-- _footer: Cell types from Schneider-Mizell et al. Nature (2025) -->

---

# Excitatory or inhibitory?

<style scoped>
a {
  position: relative;
}
img {

}
img:hover {
  box-shadow: 0 0 2px 1px rgba(0, 140, 186, 0.5);
}
</style>

<div class="columns">
<div>

##### A) <a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/4927362740256768"><img src="../../images/ssa/e_vs_i_spines/state=4927362740256768.png"></img></a>


</div>
<div>

##### B)

<a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/5018403698900992"><img src="../../images/ssa/e_vs_i_spines/state=5018403698900992.png"></img></a>


</div>
<div>

##### C)

<a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/5294319914188800"><img src="../../images/ssa/e_vs_i_spines/state=5294319914188800.png"></img></a>

</div>
</div>

<div class="columns">
<div>

##### D)

<a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/4938240147587072"><img src="../../images/ssa/e_vs_i_spines/state=4938240147587072.png"></img></a>


</div>
<div>

##### E)

<a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/5256989132193792"><img src="../../images/ssa/e_vs_i_spines/state=5256989132193792.png"></img></a>

</div>
<div>

##### F)

<a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/6342512605134848"><img src="../../images/ssa/e_vs_i_spines/state=6342512605134848.png"></img></a>

</div>
</div>

---

# Excitatory or inhibitory?

<style scoped>
a {
  position: relative;
}
img {

}
img:hover {
  box-shadow: 0 0 2px 1px rgba(0, 140, 186, 0.5);
}
</style>

<div class="columns">
<div>

##### Inhibitory <a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/4927362740256768"><img src="../../images/ssa/e_vs_i_spines/state=4927362740256768.png"></img></a>


</div>
<div>

##### Excitatory

<a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/5018403698900992"><img src="../../images/ssa/e_vs_i_spines/state=5018403698900992.png"></img></a>


</div>
<div>

##### Inhibitory

<a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/5294319914188800"><img src="../../images/ssa/e_vs_i_spines/state=5294319914188800.png"></img></a>

</div>
</div>

<div class="columns">
<div>

##### Excitatory

<a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/4938240147587072"><img src="../../images/ssa/e_vs_i_spines/state=4938240147587072.png"></img></a>


</div>
<div>

##### Inhibitory

<a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/5256989132193792"><img src="../../images/ssa/e_vs_i_spines/state=5256989132193792.png"></img></a>

</div>
<div>

##### Excitatory

<a href="https://spelunker.cave-explorer.org/#!middleauth+https://global.daf-apis.com/nglstate/api/v1/6342512605134848"><img src="../../images/ssa/e_vs_i_spines/state=6342512605134848.png"></img></a>

</div>
</div>

---

# Inhibitory neurons

<div style="font-size:20px; padding: 0px; position: absolute; top: 0.6in; right: 0.7in;">
<span style="color: var(--soma);">soma</span> <span style="color: var(--shaft);">shaft</span> <span style="color: var(--spine);">spine</span>
</div>

<div class="columns">
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691135082840567-BC.svg" />
<figcaption >
Basket
</figcaption>
</figure>

</div>
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691135865240702-BC.svg" />
<figcaption >
Basket
</figcaption>
</figure>

</div>
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691135339516390-MC.svg" />
<figcaption >
Martinotti
</figcaption>
</figure>

</div>
</div>

<div class="columns">
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691135777888864-MC.svg"/>
<figcaption >
Martinotti
</figcaption>
</figure>

</div>
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691135976155459-NGC.svg"/>
<figcaption >
Neurogliaform
</figcaption>
</figure>

<!-- cover some axon that didn't get pruned -->
<div style="position: absolute; top: 6.25in; left: 8.25in; background-color: white; width:10px; height:10px; border-width: 0px; border-color: black; border-style: solid;"></div>

</div>
<div>

<figure class="fig">
<img src="../../images/ssa/new_posterior_plots/864691135386940245-BPC.svg"/>
<figcaption >
Bipolar
</figcaption>
</figure>

</div>
</div>

<!-- _footer: Cell types from Schneider-Mizell et al. Nature (In press) -->


---

# Zero-shot prediction on a human neuron

<div style="font-size:16px">
<span style="color: var(--soma);">soma</span> <span style="color: var(--shaft);">shaft</span> <span style="color: var(--spine);">spine</span>
</div>

<div>
<embed src="../../images/ssa/h01/h01_posterior.svg" width="96%" height="520px" name="h01_posterior"></embed>

<a href="../../images/ssa/h01/h01_posterior.html" target="h01_posterior">
<img src="./../.../../images/ssa/icons/search.svg"></img>
</a>
</div>

<!-- _footer: Shapson-Coe et al. _Science_ 2024  -->

---

# Laplacian eigenvectors

<div class="columns">
<div>

### 1D grid

![](../../images/ssa/discrete_heat/1d_eigenvectors.svg)

</div>
<div>

### 2D grid

![](../../images/ssa/discrete_heat/plane_eigenvector_199.svg)

</div>
<div>

### Mesh

<div>
<embed src="../../images/ssa/show_heat_diffusion/eigenvector_on_mesh.html" width="96%" height="380px" name="eigenvector_on_mesh"></embed>

</div>

</div>
</div>

* Eigendecomposition allows you to compute HKS for every point simultaneously
* Takes several hours for a full neuron mesh

---

# Other applications? - Segmenting thalamic boutons

![h:550 center](../../images/ssa/boutons/boutons.png)

---

# Computational improvements

<div class="columns">
<div>

- Overlapping mesh subdivision
* Mesh simplification (Garland and Heckbert 1997)
* Band-by-band eigendecomposition (Vallet and Levy 2008)
* Robust laplacian (Sharp and Crane 2020)
* Mesh agglomeration (for compressed storage)

</div>
<div>

<figure class='fig'>
<img src="../../images/ssa/show_mesh_splitting/submeshes.svg" height=260px/>
<figcaption>
Subdivided mesh
</figcaption>
</figure>

<figure class='fig'>
<img src="../../images/ssa/show_mesh_splitting/submeshes_overlapped.svg" height=260px/>
<figcaption>
Subdivided mesh with overlap
</figcaption>
</figure>

</div>
</div>


---

# Timing and compute

<!-- TODO SCI compare to the version without these speedups -->

<div class="columns">
<div>

- Deployed on Google Kubernetes Engine
- ~20 minutes per neuron per CPU
  - ~2 minutes on your laptop
- Runs on cheap nodes (no GPUs)
- Mean cost **~0.5 cents per neuron**

<!-- ![center h:420](../../images/ssa/timing/timing_n_vertices_vs_wall_time.svg) -->

</div>
<div>

![center](../../images/ssa/timing_foggy_forest_call/effective_time_scatter_by_size.svg)

<!-- ![center h:420](../../images/ssa/timing/timing_n_vertices_vs_wall_time_per_root.svg) -->

</div>
</div>


---

# Compressed storage via agglomeration

<!-- ![h:550 center](../../images/ssa/diagram_agglomeration/side_by_side.svg) -->

<div class="columns">
<div>

HKS feature

![h:500 center](../../images/ssa/diagram_agglomeration/panel1.svg)

</div>
<div>

Agglomeration regions

![h:500 center](../../images/ssa/diagram_agglomeration/panel2.svg)

</div>
<div>

Reconstructed feature

![h:500 center](../../images/ssa/diagram_agglomeration/panel3.svg)

</div>
</div>


---

# Computing HKS representations

<div class="columns">

<div>

- Evolution of heat $u$ governed by:
  $$\frac{\partial{u}}{\partial{t}} = L u$$  
  where L is Laplacian operator
- Heat remaining at $x$ after $t$ is:
  $$k_t(x) = \sum_{i=0}^{\infty} e^{-\lambda_i t} \phi_i(x)^2 \approx \sum_{i=0}^{K} e^{-\lambda_i t} \phi_i(x)^2 $$
  where ($\lambda_i$, $\phi_i$) are eigenpairs of $L$

<!-- * <div id="highlightbox"> We just need these eigenvectors/eigenvalues to compute HKS </div> -->

</div>

<div>

<div>
<!-- <embed src="../../images/ssa/show_heat_diffusion/eigenvector_on_mesh.html" width="96%" height="380px" name="eigenvector_on_mesh"></embed> -->

<figure class='fig' >
<img src="../../images/ssa/explain_pipeline/mesh_eigenvectors.png" style="display: block;" height="350px"></img>

<belowcaption>

_Eigenvectors of mesh Laplacian_

</belowcaption>

</figure>

</div>

</div>
</div>

* The good: only need (sparse) eigendecomposition
* The bad: would still take several hours per neuron

<!-- _footer: https://en.wikipedia.org/wiki/Heat_kernel -->

---

## Extensions
<div class="columns">
<div>

* Cell type specificity in subcellular targeting
* Finding multi-input spines
* Spine morphometry (e.g. volume, area, sphericity)

</div>
<div>

![h:220](../../images/ssa/multiinput.png)

</div>
</div>

## Other applications

<div class="columns">
<div>

* Bouton segmentation
* **Presynaptic E/I classification**

</div>
<div>

![h:220](../../images/ssa/boutons/boutons.png)

</div>
</div>

---
<style scoped>
.fig belowcaption {
    position: absolute;
    bottom: 0%;
    left: 15%;
    vertical-align: top;
    text-anchor: start;
    font-size: 20px;
    font-weight: normal;
}
</style>

# Modern volume EM datasets

<div class="columns">
<div>

<figure class='fig'>
<img src="../../images/ssa/microns_covers/minnie_activity_12color.png" style="display: block;" data-morph="microns"></img>

<belowcaption>

MICrONS - Image by Forrest Collman

</belowcaption>

</figure>

</div>
<div>

* Machine annotation: how do we find anything?
* SegCLR (Dorkenwald et al. Nature Methods 2023), SynapseCLR (Wilson et al. Patterns 2023), NEURD (Celli et al. Nature 2025), Soma-nucleus model (Elabaddy et al. Nature 2025), GraphDINO (Weis et al. Nature Comm. 2025), PSS autoencoder (Seshamani et al. arXiv 2020) ...

</div>
</div>

<!-- _footer: MICrONS consortium et al. Nature (2025) -->


---

# Run on MICrONS / V1DD

<div class="columns">
<div>

* Ran on ~75K neurons, ~208M synapses classified
* ~$250 in cloud compute cost (1/4 cent per neuron)
* HKS representations stored for future use/model update
* Version 2 (V1DD): ~65K neurons, 163M synapses
* Available in CAVE tables and Neuroglancer

<!-- into &nbsp; <br> { <span style="color: rgb(0, 227, 255);">soma</span> <span style="color: rgb(239, 230, 69);">shaft</span> <span style="color: rgb(233, 53, 161);">spine</span> } -->

</div>
<div>

<figure class="fig">
<img src="../../images/ssa/synapse_spatial/synapse_cloud_layered.svg" height=500px/>
<belowcaption>

_~1 million (0.5%) of classified synapses_

</belowcaption>
</figure>

</div>
</div>

---

# Community interest in spines in EM: VORTEX

<div class="columns">
<div>

VORTEX - supporting community engagement with MICrONS

* Basket cells onto spines with multiple inputs
* Find spine head apparatus
* Biophysical modeling of spine heads

</div>
<div>

</div>
</div>